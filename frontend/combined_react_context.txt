-- ./src/app/App.tsx --
// src/app/App.tsx
import { Route, Routes } from 'react-router';
import TravelPlannerHome from '../pages/travel/TravelPlannerHome';
import { useTheme } from '../hooks/useTheme';
import '../styles/App.css';

function App() {
  // Initialize theme system
  useTheme();

  return (
    <div className="min-h-screen bg-white dark:bg-gray-900 theme-transition">
      <Routes>
        {/* Home route - Travel Planner */}
        <Route path="/" element={<TravelPlannerHome />} />
        {/* 404 Route - must be last */}
        <Route path="*" element={<NotFound />} />
      </Routes>
    </div>
  );
}

// Simple 404 component with dark theme support
const NotFound = () => (
  <div className="min-h-screen flex items-center justify-center bg-gray-50 dark:bg-gray-900 theme-transition">
    <div className="text-center">
      <h1 className="text-6xl font-bold text-gray-900 dark:text-white mb-4 theme-transition">404</h1>
      <p className="text-xl text-gray-600 dark:text-gray-300 mb-8 theme-transition">Page not found</p>
      <a
        href="/"
        className="bg-blue-600 hover:bg-blue-700 dark:bg-blue-500 dark:hover:bg-blue-600 text-white px-6 py-3 rounded-lg transition-colors theme-transition"
      >
        Go Home
      </a>
    </div>
  </div>
);

export default App;

-- ./src/app/main.tsx --
// src/app/main.tsx
import ReactDOM from "react-dom/client";
import App from "./App";
import '../styles/index.css'
import '../styles/App.css'
import { Provider } from "react-redux";
import { store } from "./store/store";
import { BrowserRouter } from "react-router";

// Ensure root element exists and is not null
const rootElement = document.getElementById("root");

if (rootElement) {
  ReactDOM.createRoot(rootElement).render(
    <Provider store={store}>
      <BrowserRouter>
        <App />
      </BrowserRouter>
    </Provider>
  );
} else {
  throw new Error("Root element not found");
}

-- ./src/app/store/hooks.ts --
import { useDispatch, useSelector } from 'react-redux';
import type { TypedUseSelectorHook } from 'react-redux';
import type { RootState, AppDispatch } from './store';

// Use throughout your app instead of plain `useDispatch` and `useSelector`
export const useAppDispatch = () => useDispatch<AppDispatch>();
export const useAppSelector: TypedUseSelectorHook<RootState> = useSelector;

// Alternative export pattern (you can use either approach)
export const useTypedDispatch = () => useDispatch<AppDispatch>();
export const useTypedSelector: TypedUseSelectorHook<RootState> = useSelector;

-- ./src/app/store/store.ts --
// src/app/store/store.ts
import { configureStore } from "@reduxjs/toolkit";
import { setupListeners } from "@reduxjs/toolkit/query";
import { travelApi } from "../../services/api/travel/travelApi";
import themeSlice from "../../features/theme/themeSlice";

export const store = configureStore({
    reducer: {
        [travelApi.reducerPath]: travelApi.reducer, // Add travel API reducer
        theme: themeSlice, // Add theme reducer
    },
    middleware: (getDefaultMiddleware) =>
        getDefaultMiddleware().concat(
            travelApi.middleware // Add travel API middleware
        ),
});

// Optional: For refetchOnFocus/refetchOnReconnect
setupListeners(store.dispatch);

// Inferred types for app-wide usage
export type RootState = ReturnType<typeof store.getState>;
export type AppDispatch = typeof store.dispatch;

-- ./src/features/auth/authSlice.ts --


-- ./src/features/theme/themeSlice.ts --
// src/features/theme/themeSlice.ts
import { createSlice } from '@reduxjs/toolkit';
import type { PayloadAction } from '@reduxjs/toolkit';

export type ThemeMode = 'light' | 'dark' | 'system';

interface ThemeState {
    mode: ThemeMode;
    isDark: boolean;
    systemPreference: 'light' | 'dark';
    isInitialized: boolean;
}

// Initial state - will be properly set when component mounts
const initialState: ThemeState = {
    mode: 'system',
    isDark: false,
    systemPreference: 'light',
    isInitialized: false
};

// Helper function to calculate isDark
const calculateIsDark = (mode: ThemeMode, systemPreference: 'light' | 'dark'): boolean => {
    switch (mode) {
        case 'dark':
            return true;
        case 'light':
            return false;
        case 'system':
            return systemPreference === 'dark';
        default:
            return false;
    }
};

// Helper function to get system preference
const getSystemPreference = (): 'light' | 'dark' => {
    if (typeof window !== 'undefined' && window.matchMedia) {
        return window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light';
    }
    return 'light';
};

// Helper function to get saved theme
const getSavedTheme = (): ThemeMode => {
    if (typeof window !== 'undefined') {
        const saved = localStorage.getItem('theme');
        if (saved === 'light' || saved === 'dark' || saved === 'system') {
            return saved;
        }
    }
    return 'system';
};

const themeSlice = createSlice({
    name: 'theme',
    initialState,
    reducers: {
        initializeTheme: (state) => {
            console.log('🎨 Initializing theme...');

            // Get current values
            const systemPreference = getSystemPreference();
            const savedMode = getSavedTheme();
            const isDark = calculateIsDark(savedMode, systemPreference);

            console.log('🎨 Theme init values:', { savedMode, systemPreference, isDark });

            // Update state
            state.mode = savedMode;
            state.systemPreference = systemPreference;
            state.isDark = isDark;
            state.isInitialized = true;

            console.log('🎨 Theme initialized:', state);
        },

        setThemeMode: (state, action: PayloadAction<ThemeMode>) => {
            console.log('🎨 Setting theme mode to:', action.payload);

            state.mode = action.payload;
            state.isDark = calculateIsDark(action.payload, state.systemPreference);

            // Save to localStorage
            if (typeof window !== 'undefined') {
                localStorage.setItem('theme', action.payload);
                console.log('🎨 Saved to localStorage:', action.payload);
            }

            console.log('🎨 New theme state:', { mode: state.mode, isDark: state.isDark });
        },

        toggleTheme: (state) => {
            console.log('🎨 Toggling theme from:', state.mode, 'isDark:', state.isDark);

            // Simple toggle between light and dark
            const newMode: ThemeMode = state.isDark ? 'light' : 'dark';

            state.mode = newMode;
            state.isDark = newMode === 'dark';

            // Save to localStorage
            if (typeof window !== 'undefined') {
                localStorage.setItem('theme', newMode);
                console.log('🎨 Toggled and saved to localStorage:', newMode);
            }

            console.log('🎨 After toggle:', { mode: state.mode, isDark: state.isDark });
        },

        setSystemPreference: (state, action: PayloadAction<'light' | 'dark'>) => {
            console.log('🎨 System preference changed to:', action.payload);

            state.systemPreference = action.payload;

            // Recalculate isDark only if in system mode
            if (state.mode === 'system') {
                const newIsDark = action.payload === 'dark';
                console.log('🎨 Updating isDark due to system change:', newIsDark);
                state.isDark = newIsDark;
            }
        },
    },
});

export const { initializeTheme, setThemeMode, toggleTheme, setSystemPreference } = themeSlice.actions;
export default themeSlice.reducer;

// Selectors
export const selectThemeMode = (state: { theme: ThemeState }) => state.theme.mode;
export const selectIsDark = (state: { theme: ThemeState }) => state.theme.isDark;
export const selectSystemPreference = (state: { theme: ThemeState }) => state.theme.systemPreference;
export const selectIsInitialized = (state: { theme: ThemeState }) => state.theme.isInitialized;

-- ./src/utils/constants/api_constants.ts --
export class ApiConstants {
    static readonly DUMMY_JSON_BASE_URL = "https://dummyjson.com";
    static readonly TRAVEL_API_BASE_URL = "https://074c-152-52-60-98.ngrok-free.app";
    static readonly TRAVEL_QUERY_ENDPOINT = "/query";
}

-- ./src/utils/constants/app_constants.ts --
// Default example questions for the travel planner
export const EXAMPLE_TRAVEL_QUESTIONS = [
    "Plan a 5-day trip to Paris with a budget of $2000",
    "Show me a budget-friendly plan for Bangkok",
    "Plan a family vacation in Tokyo for 7 days",
    "Create an adventure trip to New Zealand",
    "Plan a romantic getaway to Santorini",
    "Show me an off-beat plan for Pattaya",
    "Plan a backpacking trip through Southeast Asia"
];

// Travel plan section types - using const object instead of enum
export const TravelSectionType = {
    ITINERARY: 'itinerary',
    HOTELS: 'hotels',
    RESTAURANTS: 'restaurants',
    ACTIVITIES: 'activities',
    TRANSPORTATION: 'transportation',
    BUDGET: 'budget',
    WEATHER: 'weather',
    ATTRACTIONS: 'attractions'
} as const;

// Type for the section values
export type TravelSectionTypeValue = typeof TravelSectionType[keyof typeof TravelSectionType];

// Helper function to get section type from title
export const getSectionType = (title: string): TravelSectionTypeValue => {
    const lowerTitle = title.toLowerCase();

    if (lowerTitle.includes('hotel')) return TravelSectionType.HOTELS;
    if (lowerTitle.includes('restaurant') || lowerTitle.includes('food')) return TravelSectionType.RESTAURANTS;
    if (lowerTitle.includes('cost') || lowerTitle.includes('budget')) return TravelSectionType.BUDGET;
    if (lowerTitle.includes('transport')) return TravelSectionType.TRANSPORTATION;
    if (lowerTitle.includes('attraction') || lowerTitle.includes('places')) return TravelSectionType.ATTRACTIONS;
    if (lowerTitle.includes('weather')) return TravelSectionType.WEATHER;
    if (lowerTitle.includes('activit')) return TravelSectionType.ACTIVITIES;

    return TravelSectionType.ITINERARY; // default
};

-- ./src/utils/validation/schema.ts --
// src/utils/validation/schemas.ts
import { z } from 'zod';

// Travel API Schemas
export const travelQuerySchema = z.object({
    question: z.string()
        .min(10, 'Please provide more details about your travel plans (at least 10 characters)')
        .max(500, 'Please keep your question under 500 characters')
        .refine(
            (val) => val.toLowerCase().includes('trip') ||
                val.toLowerCase().includes('travel') ||
                val.toLowerCase().includes('vacation') ||
                val.toLowerCase().includes('plan') ||
                val.toLowerCase().includes('visit'),
            'Please include travel-related keywords in your question'
        )
});

export const travelResponseSchema = z.object({
    answer: z.string().min(1, 'Response cannot be empty')
});

// Counter State Schema
export const counterStateSchema = z.object({
    value: z.number().int('Counter value must be an integer')
});

// API Constants Schema
export const apiConstantsSchema = z.object({
    DUMMY_JSON_BASE_URL: z.string().url('Invalid dummy JSON base URL'),
    TRAVEL_API_BASE_URL: z.string().url('Invalid travel API base URL'),
    TRAVEL_QUERY_ENDPOINT: z.string().startsWith('/', 'Endpoint must start with /')
});

// Form Validation Schemas
export const travelFormSchema = z.object({
    destination: z.string().optional(),
    budget: z.number().positive('Budget must be positive').optional(),
    duration: z.number().positive('Duration must be positive').optional(),
    travelType: z.enum(['leisure', 'business', 'adventure', 'romantic', 'family']).optional(),
    question: travelQuerySchema.shape.question
});

// Environment Variables Schema
export const envSchema = z.object({
    NODE_ENV: z.enum(['development', 'production', 'test']).default('development'),
    VITE_API_BASE_URL: z.string().url().optional(),
    VITE_TRAVEL_API_URL: z.string().url().optional()
});

// Types derived from schemas
export type TravelQuery = z.infer<typeof travelQuerySchema>;
export type TravelResponse = z.infer<typeof travelResponseSchema>;
export type CounterState = z.infer<typeof counterStateSchema>;
export type TravelForm = z.infer<typeof travelFormSchema>;

// Validation helper functions
export const validateApiConstants = (constants: any) => {
    return apiConstantsSchema.safeParse(constants);
};

export const validateTravelQuery = (query: any) => {
    return travelQuerySchema.safeParse(query);
};

export const validateTravelResponse = (response: any) => {
    return travelResponseSchema.safeParse(response);
};

export const validateCounterState = (state: any) => {
    return counterStateSchema.safeParse(state);
};

export const validateTravelForm = (form: any) => {
    return travelFormSchema.safeParse(form);
};

-- ./src/postcss.config.ts --
const config = {
    plugins: {
        tailwindcss: {},
        autoprefixer: {},
    },
}

export default config

-- ./src/styles/App.css --
/* #root {
  max-width: 1280px;
  margin: 0 auto;
  padding: 2rem;
  text-align: center;
} */

#root {
  width: 100%;
  height: 100vh;
  margin: 0;
  padding: 0;
}



-- ./src/styles/index.css --
@import 'tailwindcss/base';
@import 'tailwindcss/components';
@import 'tailwindcss/utilities';

body {
  margin: 0;
  min-width: 320px;
  min-height: 100vh;
}

/* Prevent flash of unstyled content during theme changes */
html {
  color-scheme: light dark;
}

/* Theme transition utility - enhanced for better performance */
.theme-transition {
  transition-property: background-color, border-color, color, box-shadow, fill, stroke;
  transition-duration: 200ms;
  transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1);
}

/* Smooth scrolling with theme awareness */
* {
  scroll-behavior: smooth;
}

/* Enhanced scrollbar styling for better dark mode support */
::-webkit-scrollbar {
  width: 8px;
  height: 8px;
}

::-webkit-scrollbar-track {
  background: rgb(243 244 246);
}

::-webkit-scrollbar-thumb {
  background: rgb(156 163 175);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb:hover {
  background: rgb(107 114 128);
}

/* Dark mode scrollbar styling */
.dark ::-webkit-scrollbar-track {
  background: rgb(31 41 55);
}

.dark ::-webkit-scrollbar-thumb {
  background: rgb(75 85 99);
}

.dark ::-webkit-scrollbar-thumb:hover {
  background: rgb(107 114 128);
}

/* Firefox scrollbar support */
html {
  scrollbar-width: thin;
  scrollbar-color: rgb(156 163 175) rgb(243 244 246);
}

.dark html {
  scrollbar-color: rgb(75 85 99) rgb(31 41 55);
}

/* Focus styles that work with both themes */
.focus-visible:focus-visible {
  outline: 2px solid rgb(99 102 241);
  outline-offset: 2px;
}

.dark .focus-visible:focus-visible {
  outline-color: rgb(129 140 248);
}

/* Reduced motion support */
@media (prefers-reduced-motion: reduce) {
  .theme-transition {
    transition: none;
  }
  
  * {
    scroll-behavior: auto;
  }
}

/* Force dark mode styles to work - debugging aid */
.dark {
  color-scheme: dark;
}

/* Test styles to verify dark mode is working */
.debug-dark-test {
  background-color: white;
}

.dark .debug-dark-test {
  background-color: #1f2937 !important;
  color: white !important;
}

-- ./src/components/ui/Loaders.tsx --
// src/components/ui/Loaders.tsx
import React from 'react';
import { MapPin, Plane, Calendar } from 'lucide-react';

// Simple spinner loader
export const Spinner: React.FC<{ size?: 'sm' | 'md' | 'lg'; color?: string }> = ({
    size = 'md',
    color = 'text-indigo-600 dark:text-indigo-400'
}) => {
    const sizeClasses = {
        sm: 'w-4 h-4',
        md: 'w-8 h-8',
        lg: 'w-12 h-12'
    };

    return (
        <div className={`${sizeClasses[size]} ${color} animate-spin theme-transition`}>
            <div className="w-full h-full border-2 border-current border-t-transparent rounded-full"></div>
        </div>
    );
};

// Travel planning specific loader
export const TravelPlanningLoader: React.FC = () => {
    return (
        <div className="bg-white dark:bg-gray-800 rounded-2xl shadow-lg p-12 text-center border border-gray-100 dark:border-gray-700 theme-transition">
            <div className="flex justify-center space-x-4 mb-6">
                <div className="animate-bounce" style={{ animationDelay: '0ms' }}>
                    <MapPin className="w-8 h-8 text-indigo-600 dark:text-indigo-400 theme-transition" />
                </div>
                <div className="animate-bounce" style={{ animationDelay: '150ms' }}>
                    <Plane className="w-8 h-8 text-blue-600 dark:text-blue-400 theme-transition" />
                </div>
                <div className="animate-bounce" style={{ animationDelay: '300ms' }}>
                    <Calendar className="w-8 h-8 text-green-600 dark:text-green-400 theme-transition" />
                </div>
            </div>
            <h3 className="text-xl font-semibold text-gray-900 dark:text-white mb-2 theme-transition">Creating Your Perfect Trip</h3>
            <p className="text-gray-600 dark:text-gray-300 mb-4 theme-transition">Our AI is analyzing destinations, costs, and creating your personalized itinerary...</p>
            <div className="w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2 theme-transition">
                <div className="bg-indigo-600 dark:bg-indigo-400 h-2 rounded-full animate-pulse theme-transition" style={{ width: '70%' }}></div>
            </div>
        </div>
    );
};

// Skeleton loader for travel plans
export const TravelPlanSkeleton: React.FC = () => {
    return (
        <div className="space-y-6">
            {[1, 2, 3].map((item) => (
                <div key={item} className="bg-white dark:bg-gray-800 rounded-xl p-6 shadow-sm border border-gray-100 dark:border-gray-700 theme-transition">
                    <div className="flex items-center space-x-3 mb-4">
                        <div className="w-10 h-10 bg-gray-200 dark:bg-gray-600 rounded-lg animate-pulse theme-transition"></div>
                        <div className="h-6 bg-gray-200 dark:bg-gray-600 rounded w-1/3 animate-pulse theme-transition"></div>
                    </div>
                    <div className="space-y-2">
                        <div className="h-4 bg-gray-200 dark:bg-gray-600 rounded w-full animate-pulse theme-transition"></div>
                        <div className="h-4 bg-gray-200 dark:bg-gray-600 rounded w-5/6 animate-pulse theme-transition"></div>
                        <div className="h-4 bg-gray-200 dark:bg-gray-600 rounded w-4/6 animate-pulse theme-transition"></div>
                    </div>
                </div>
            ))}
        </div>
    );
};

// Generic loading overlay
export const LoadingOverlay: React.FC<{ message?: string }> = ({
    message = 'Loading...'
}) => {
    return (
        <div className="fixed inset-0 bg-black bg-opacity-50 dark:bg-black dark:bg-opacity-70 flex items-center justify-center z-50 theme-transition">
            <div className="bg-white dark:bg-gray-800 rounded-lg p-8 max-w-sm mx-4 text-center border border-gray-200 dark:border-gray-700 theme-transition">
                <Spinner size="lg" />
                <p className="mt-4 text-gray-700 dark:text-gray-300 font-medium theme-transition">{message}</p>
            </div>
        </div>
    );
};

// Theme-aware pulse loader
export const ThemeAwarePulse: React.FC<{ className?: string }> = ({ className = '' }) => {
    return (
        <div className={`animate-pulse ${className}`}>
            <div className="bg-gray-200 dark:bg-gray-600 rounded theme-transition"></div>
        </div>
    );
};

// Progress bar with theme support
export const ProgressBar: React.FC<{
    progress: number;
    className?: string;
    showPercentage?: boolean;
}> = ({
    progress,
    className = '',
    showPercentage = false
}) => {
        const clampedProgress = Math.min(Math.max(progress, 0), 100);

        return (
            <div className={`w-full ${className}`}>
                <div className="flex justify-between items-center mb-1">
                    {showPercentage && (
                        <span className="text-sm font-medium text-gray-700 dark:text-gray-300 theme-transition">
                            {Math.round(clampedProgress)}%
                        </span>
                    )}
                </div>
                <div className="w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2 theme-transition">
                    <div
                        className="bg-indigo-600 dark:bg-indigo-400 h-2 rounded-full transition-all duration-500 ease-out theme-transition"
                        style={{ width: `${clampedProgress}%` }}
                    ></div>
                </div>
            </div>
        );
    };

export default {
    Spinner,
    TravelPlanningLoader,
    TravelPlanSkeleton,
    LoadingOverlay,
    ThemeAwarePulse,
    ProgressBar
};

-- ./src/components/ui/ThemeToggle.tsx --
// src/components/ui/ThemeToggle.tsx
import React from 'react';
import { Sun, Moon, Monitor } from 'lucide-react';
import { useAppDispatch, useAppSelector } from '../../app/store/hooks';
import {
    setThemeMode,
    toggleTheme,
    selectThemeMode,
    selectIsDark,
    selectIsInitialized,
    type ThemeMode
} from '../../features/theme/themeSlice';

interface ThemeToggleProps {
    variant?: 'simple' | 'detailed';
    size?: 'sm' | 'md' | 'lg';
}

const ThemeToggle: React.FC<ThemeToggleProps> = ({
    variant = 'simple',
    size = 'md'
}) => {
    const dispatch = useAppDispatch();
    const themeMode = useAppSelector(selectThemeMode);
    const isDark = useAppSelector(selectIsDark);
    const isInitialized = useAppSelector(selectIsInitialized);

    const handleToggle = () => {
        console.log('🎛️ ThemeToggle: Toggle clicked, current state:', { themeMode, isDark });
        console.log('🎛️ ThemeToggle: DOM classes before toggle:', document.documentElement.classList.toString());

        dispatch(toggleTheme());

        // Log after a brief delay to see the change
        setTimeout(() => {
            console.log('🎛️ ThemeToggle: DOM classes after toggle:', document.documentElement.classList.toString());
        }, 100);
    };

    const handleModeSelect = (mode: ThemeMode) => {
        console.log('🎛️ ThemeToggle: Mode selected:', mode);
        dispatch(setThemeMode(mode));
    };

    // Show loading state if not initialized
    if (!isInitialized) {
        return (
            <div className="w-10 h-10 bg-gray-200 dark:bg-gray-700 rounded-lg animate-pulse theme-transition"></div>
        );
    }

    const sizeClasses = {
        sm: 'w-8 h-8',
        md: 'w-10 h-10',
        lg: 'w-12 h-12'
    };

    const iconSizes = {
        sm: 'w-4 h-4',
        md: 'w-5 h-5',
        lg: 'w-6 h-6'
    };

    if (variant === 'simple') {
        return (
            <div className="relative">
                {/* Debug info */}
                <div className="absolute -top-8 left-0 text-xs text-gray-500 whitespace-nowrap pointer-events-none">
                    {themeMode} | {isDark ? 'dark' : 'light'}
                </div>

                <button
                    onClick={handleToggle}
                    className={`
                        ${sizeClasses[size]} 
                        flex items-center justify-center
                        bg-gray-100 hover:bg-gray-200 
                        dark:bg-gray-800 dark:hover:bg-gray-700
                        rounded-lg transition-all duration-200
                        focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2
                        dark:focus:ring-offset-gray-900
                        theme-transition
                        border-2
                        ${isDark ? 'border-yellow-400' : 'border-blue-400'}
                    `}
                    aria-label={`Switch to ${isDark ? 'light' : 'dark'} theme`}
                    title={`Current: ${themeMode} theme (${isDark ? 'dark' : 'light'}). Click to toggle.`}
                >
                    {isDark ? (
                        <Sun className={`${iconSizes[size]} text-yellow-500`} />
                    ) : (
                        <Moon className={`${iconSizes[size]} text-gray-600 dark:text-gray-300`} />
                    )}
                </button>
            </div>
        );
    }

    return (
        <div className="relative">
            <div className="flex items-center space-x-1 bg-gray-100 dark:bg-gray-800 rounded-lg p-1 theme-transition">
                {(['light', 'system', 'dark'] as ThemeMode[]).map((mode) => {
                    const isActive = themeMode === mode;
                    const Icon = mode === 'light' ? Sun : mode === 'dark' ? Moon : Monitor;

                    return (
                        <button
                            key={mode}
                            onClick={() => handleModeSelect(mode)}
                            className={`
                                ${sizeClasses[size]}
                                flex items-center justify-center rounded-md transition-all duration-200
                                focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2
                                dark:focus:ring-offset-gray-900
                                ${isActive
                                    ? 'bg-white dark:bg-gray-700 text-indigo-600 dark:text-indigo-400 shadow-sm'
                                    : 'text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-200'
                                }
                                theme-transition
                            `}
                            aria-label={`Switch to ${mode} theme`}
                            title={`${mode.charAt(0).toUpperCase() + mode.slice(1)} theme`}
                            aria-pressed={isActive}
                        >
                            <Icon className={iconSizes[size]} />
                        </button>
                    );
                })}
            </div>
        </div>
    );
};

export default ThemeToggle;

-- ./src/vite-env.d.ts --
/// <reference types="vite/client" />


-- ./src/hooks/useTheme.ts --
// src/hooks/useTheme.ts
import { useEffect } from 'react';
import { useAppDispatch, useAppSelector } from '../app/store/hooks';
import {
    initializeTheme,
    setSystemPreference,
    selectIsDark,
    selectThemeMode,
    selectSystemPreference,
    selectIsInitialized
} from '../features/theme/themeSlice';

export const useTheme = () => {
    const dispatch = useAppDispatch();
    const isDark = useAppSelector(selectIsDark);
    const themeMode = useAppSelector(selectThemeMode);
    const systemPreference = useAppSelector(selectSystemPreference);
    const isInitialized = useAppSelector(selectIsInitialized);

    // Initialize theme once when component mounts
    useEffect(() => {
        console.log('🔧 useTheme: Initializing theme...');
        dispatch(initializeTheme());
    }, [dispatch]);

    // Apply theme to DOM whenever isDark changes and theme is initialized
    useEffect(() => {
        if (!isInitialized) {
            console.log('🔧 useTheme: Skipping DOM update - not initialized yet');
            return;
        }

        console.log('🔧 useTheme: Applying theme to DOM, isDark:', isDark);

        const root = document.documentElement;

        if (isDark) {
            root.classList.add('dark');
            console.log('🔧 useTheme: Added dark class');
        } else {
            root.classList.remove('dark');
            console.log('🔧 useTheme: Removed dark class');
        }

        // Update meta theme-color for mobile browsers
        let metaThemeColor = document.querySelector('meta[name="theme-color"]');
        const themeColor = isDark ? '#1f2937' : '#ffffff';

        if (metaThemeColor) {
            metaThemeColor.setAttribute('content', themeColor);
        } else {
            metaThemeColor = document.createElement('meta');
            metaThemeColor.setAttribute('name', 'theme-color');
            metaThemeColor.setAttribute('content', themeColor);
            document.getElementsByTagName('head')[0].appendChild(metaThemeColor);
        }

        console.log('🔧 useTheme: DOM classes now:', root.classList.toString());
    }, [isDark, isInitialized]);

    // Listen for system theme changes
    useEffect(() => {
        if (typeof window === 'undefined') return;

        const mediaQuery = window.matchMedia('(prefers-color-scheme: dark)');

        const handleChange = (e: MediaQueryListEvent) => {
            console.log('🔧 useTheme: System preference changed:', e.matches ? 'dark' : 'light');
            dispatch(setSystemPreference(e.matches ? 'dark' : 'light'));
        };

        console.log('🔧 useTheme: Setting up system preference listener');

        // Set initial system preference
        const currentSystemPref = mediaQuery.matches ? 'dark' : 'light';
        console.log('🔧 useTheme: Current system preference:', currentSystemPref);

        if (systemPreference !== currentSystemPref) {
            dispatch(setSystemPreference(currentSystemPref));
        }

        // Listen for changes
        mediaQuery.addEventListener('change', handleChange);

        return () => {
            console.log('🔧 useTheme: Cleaning up system preference listener');
            mediaQuery.removeEventListener('change', handleChange);
        };
    }, [dispatch, systemPreference]);

    return {
        isDark,
        themeMode,
        systemPreference,
        isInitialized
    };
};

// Hook for theme-aware class names
export const useThemeClasses = () => {
    const { isDark } = useTheme();

    return {
        // Background classes
        bgPrimary: 'bg-white dark:bg-gray-900',
        bgSecondary: 'bg-gray-50 dark:bg-gray-800',
        bgTertiary: 'bg-gray-100 dark:bg-gray-700',

        // Text classes
        textPrimary: 'text-gray-900 dark:text-white',
        textSecondary: 'text-gray-600 dark:text-gray-300',
        textTertiary: 'text-gray-500 dark:text-gray-400',

        // Border classes
        border: 'border-gray-200 dark:border-gray-700',
        borderLight: 'border-gray-100 dark:border-gray-800',

        // Interactive classes
        hover: 'hover:bg-gray-50 dark:hover:bg-gray-800',

        // Common component classes
        card: 'bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700',
        input: 'bg-white dark:bg-gray-700 border-gray-300 dark:border-gray-600 text-gray-900 dark:text-white',
        button: 'bg-indigo-600 hover:bg-indigo-700 dark:bg-indigo-500 dark:hover:bg-indigo-600',

        // Utility
        isDark,
        transition: 'theme-transition'
    };
};

export default useTheme;

-- ./src/pages/home/HomeScreen.tsx --


-- ./src/pages/travel/TravelPlanDisplay.tsx --
// src/pages/travel/TravelPlanDisplay.tsx
import React from 'react';
import { ArrowLeft, MapPin, Calendar, DollarSign, Hotel, Utensils, Car, Camera, Sun, Activity } from 'lucide-react';
import { TravelSectionType, getSectionType, type TravelSectionTypeValue } from '../../utils/constants/app_constants';
import type { TravelResponse } from '../../services/api/travel/travelApi';

interface TravelPlanDisplayProps {
    data: TravelResponse;
    onNewSearch: () => void;
}

interface SectionIconConfig {
    icon: React.ReactNode;
    bgColor: string;
    iconColor: string;
    darkBgColor: string;
    darkIconColor: string;
}

const TravelPlanDisplay: React.FC<TravelPlanDisplayProps> = ({ data, onNewSearch }) => {
    // Parse the markdown-like content into sections
    const parseContent = (content: string): string[] => {
        const sections = content.split('---').filter(section => section.trim());
        return sections.map(section => section.trim());
    };

    const parseTableContent = (content: string) => {
        const lines = content.split('\n').filter(line => line.trim());
        const tableLines = lines.filter(line => line.includes('|'));

        if (tableLines.length < 2) return null;

        const headers = tableLines[0].split('|').map(h => h.trim()).filter(h => h);
        const rows = tableLines.slice(2).map(row =>
            row.split('|').map(cell => cell.trim()).filter(cell => cell)
        );

        return { headers, rows };
    };

    // Get section configuration based on type - using constants from app_constants.ts
    const getSectionConfig = (title: string): SectionIconConfig => {
        const sectionType = getSectionType(title);

        const configs: Record<TravelSectionTypeValue, SectionIconConfig> = {
            [TravelSectionType.ITINERARY]: {
                icon: <Calendar className="w-6 h-6" />,
                bgColor: "bg-blue-50",
                iconColor: "text-blue-600",
                darkBgColor: "dark:bg-blue-900/20",
                darkIconColor: "dark:text-blue-400"
            },
            [TravelSectionType.HOTELS]: {
                icon: <Hotel className="w-6 h-6" />,
                bgColor: "bg-purple-50",
                iconColor: "text-purple-600",
                darkBgColor: "dark:bg-purple-900/20",
                darkIconColor: "dark:text-purple-400"
            },
            [TravelSectionType.RESTAURANTS]: {
                icon: <Utensils className="w-6 h-6" />,
                bgColor: "bg-green-50",
                iconColor: "text-green-600",
                darkBgColor: "dark:bg-green-900/20",
                darkIconColor: "dark:text-green-400"
            },
            [TravelSectionType.BUDGET]: {
                icon: <DollarSign className="w-6 h-6" />,
                bgColor: "bg-yellow-50",
                iconColor: "text-yellow-600",
                darkBgColor: "dark:bg-yellow-900/20",
                darkIconColor: "dark:text-yellow-400"
            },
            [TravelSectionType.TRANSPORTATION]: {
                icon: <Car className="w-6 h-6" />,
                bgColor: "bg-indigo-50",
                iconColor: "text-indigo-600",
                darkBgColor: "dark:bg-indigo-900/20",
                darkIconColor: "dark:text-indigo-400"
            },
            [TravelSectionType.ATTRACTIONS]: {
                icon: <Camera className="w-6 h-6" />,
                bgColor: "bg-red-50",
                iconColor: "text-red-600",
                darkBgColor: "dark:bg-red-900/20",
                darkIconColor: "dark:text-red-400"
            },
            [TravelSectionType.WEATHER]: {
                icon: <Sun className="w-6 h-6" />,
                bgColor: "bg-orange-50",
                iconColor: "text-orange-600",
                darkBgColor: "dark:bg-orange-900/20",
                darkIconColor: "dark:text-orange-400"
            },
            [TravelSectionType.ACTIVITIES]: {
                icon: <Activity className="w-6 h-6" />,
                bgColor: "bg-pink-50",
                iconColor: "text-pink-600",
                darkBgColor: "dark:bg-pink-900/20",
                darkIconColor: "dark:text-pink-400"
            }
        };

        return configs[sectionType];
    };

    const renderSection = (section: string, index: number) => {
        const lines = section.split('\n').filter(line => line.trim());
        if (lines.length === 0) return null;

        const title = lines[0].replace(/#+\s*\*?\*?/, '').trim();
        const content = lines.slice(1).join('\n');

        // Get section configuration using constants
        const { icon, bgColor, iconColor, darkBgColor, darkIconColor } = getSectionConfig(title);

        // Check if content contains a table
        const tableData = parseTableContent(content);

        return (
            <div key={index} className={`${bgColor} ${darkBgColor} rounded-xl p-6 border border-gray-100 dark:border-gray-700 shadow-sm theme-transition`}>
                <div className="flex items-center space-x-3 mb-4">
                    <div className={`${iconColor} ${darkIconColor} ${bgColor} ${darkBgColor} p-2 rounded-lg theme-transition`}>
                        {icon}
                    </div>
                    <h3 className="text-xl font-bold text-gray-900 dark:text-white theme-transition">{title}</h3>
                </div>

                {tableData ? (
                    <div className="overflow-x-auto">
                        <table className="w-full bg-white dark:bg-gray-800 rounded-lg overflow-hidden shadow-sm border border-gray-100 dark:border-gray-700 theme-transition">
                            <thead className="bg-gray-50 dark:bg-gray-700">
                                <tr>
                                    {tableData.headers.map((header, i) => (
                                        <th key={i} className="px-4 py-3 text-left text-sm font-semibold text-gray-900 dark:text-white theme-transition">
                                            {header}
                                        </th>
                                    ))}
                                </tr>
                            </thead>
                            <tbody className="divide-y divide-gray-200 dark:divide-gray-600">
                                {tableData.rows.map((row, i) => (
                                    <tr key={i} className="hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors">
                                        {row.map((cell, j) => (
                                            <td key={j} className="px-4 py-3 text-sm text-gray-700 dark:text-gray-300 theme-transition">
                                                {cell}
                                            </td>
                                        ))}
                                    </tr>
                                ))}
                            </tbody>
                        </table>
                    </div>
                ) : (
                    <div className="bg-white dark:bg-gray-800 rounded-lg p-4 shadow-sm border border-gray-100 dark:border-gray-700 theme-transition">
                        {content.split('\n').map((line, i) => {
                            const trimmedLine = line.trim();

                            if (trimmedLine.startsWith('- ')) {
                                return (
                                    <div key={i} className="flex items-start space-x-2 mb-2">
                                        <div className="w-2 h-2 bg-gray-400 dark:bg-gray-500 rounded-full mt-2 flex-shrink-0 theme-transition"></div>
                                        <p className="text-gray-700 dark:text-gray-300 theme-transition">{trimmedLine.replace('- ', '')}</p>
                                    </div>
                                );
                            } else if (trimmedLine.match(/^\d+\./)) {
                                const number = trimmedLine.match(/^\d+/)?.[0];
                                const text = trimmedLine.replace(/^\d+\.\s*/, '');
                                return (
                                    <div key={i} className="flex items-start space-x-3 mb-3">
                                        <div className="bg-gray-200 dark:bg-gray-600 text-gray-700 dark:text-gray-300 text-sm font-semibold px-2 py-1 rounded-full min-w-[24px] text-center theme-transition">
                                            {number}
                                        </div>
                                        <p className="text-gray-700 dark:text-gray-300 flex-1 theme-transition">{text}</p>
                                    </div>
                                );
                            } else if (trimmedLine) {
                                return (
                                    <p key={i} className="text-gray-700 dark:text-gray-300 mb-2 leading-relaxed theme-transition">
                                        {trimmedLine}
                                    </p>
                                );
                            }
                            return null;
                        })}
                    </div>
                )}
            </div>
        );
    };

    const sections = parseContent(data.answer);

    return (
        <div className="space-y-8">
            {/* Header with back button */}
            <div className="flex items-center justify-between">
                <button
                    onClick={onNewSearch}
                    className="flex items-center space-x-2 text-indigo-600 dark:text-indigo-400 hover:text-indigo-700 dark:hover:text-indigo-300 transition-colors focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 dark:focus:ring-offset-gray-900 rounded-lg px-3 py-2 theme-transition"
                    aria-label="Plan another trip"
                >
                    <ArrowLeft className="w-5 h-5" />
                    <span className="font-medium">Plan Another Trip</span>
                </button>

                <div className="flex items-center space-x-2 text-gray-600 dark:text-gray-300 theme-transition">
                    <MapPin className="w-5 h-5" />
                    <span className="font-medium">Your Personalized Travel Plan</span>
                </div>
            </div>

            {/* Travel Plan Content */}
            <div className="space-y-6">
                {sections.length > 0 ? (
                    sections.map((section, index) => renderSection(section, index))
                ) : (
                    <div className="bg-white dark:bg-gray-800 rounded-xl p-8 text-center border border-gray-200 dark:border-gray-700 theme-transition">
                        <div className="w-16 h-16 bg-gray-100 dark:bg-gray-700 rounded-full flex items-center justify-center mx-auto mb-4 theme-transition">
                            <MapPin className="w-8 h-8 text-gray-400 dark:text-gray-500" />
                        </div>
                        <h3 className="text-lg font-semibold text-gray-900 dark:text-white mb-2 theme-transition">No Travel Plan Found</h3>
                        <p className="text-gray-600 dark:text-gray-300 mb-4 theme-transition">We couldn't parse your travel plan. Please try generating a new one.</p>
                        <button
                            onClick={onNewSearch}
                            className="px-6 py-3 bg-indigo-600 hover:bg-indigo-700 dark:bg-indigo-500 dark:hover:bg-indigo-600 text-white rounded-lg transition-colors theme-transition"
                        >
                            Generate New Plan
                        </button>
                    </div>
                )}
            </div>

            {/* Action Buttons */}
            <div className="bg-white dark:bg-gray-800 rounded-xl p-6 shadow-sm border border-gray-100 dark:border-gray-700 theme-transition">
                <div className="flex flex-col sm:flex-row gap-4 justify-center">
                    <button
                        className="px-6 py-3 bg-indigo-600 hover:bg-indigo-700 dark:bg-indigo-500 dark:hover:bg-indigo-600 text-white rounded-lg transition-colors font-medium focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 dark:focus:ring-offset-gray-900 theme-transition"
                        aria-label="Save this travel plan"
                    >
                        Save This Plan
                    </button>
                    <button
                        className="px-6 py-3 bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors font-medium focus:outline-none focus:ring-2 focus:ring-gray-500 focus:ring-offset-2 dark:focus:ring-offset-gray-900 theme-transition"
                        aria-label="Share this travel plan"
                    >
                        Share Plan
                    </button>
                    <button
                        onClick={onNewSearch}
                        className="px-6 py-3 bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-400 rounded-lg hover:bg-green-200 dark:hover:bg-green-900/50 transition-colors font-medium focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2 dark:focus:ring-offset-gray-900 theme-transition"
                        aria-label="Create a new travel plan"
                    >
                        Create New Plan
                    </button>
                </div>
            </div>
        </div>
    );
};

export default TravelPlanDisplay;

-- ./src/pages/travel/TravelPlannerHome.tsx --
// src/pages/travel/TravelPlannerHome.tsx
import React, { useState, useCallback } from 'react';
import { Send, MapPin, Calendar, DollarSign, Hotel, Utensils, Camera, ArrowRight, AlertCircle } from 'lucide-react';
import { useGetTravelPlanMutation } from '../../services/api/travel/travelApi';
import { EXAMPLE_TRAVEL_QUESTIONS } from '../../utils/constants/app_constants';
import TravelPlanDisplay from './TravelPlanDisplay';
import ThemeToggle from '../../components/ui/ThemeToggle';

interface ValidationError {
    field: string;
    message: string;
}

const TravelPlannerHome: React.FC = () => {
    const [question, setQuestion] = useState('');
    const [validationErrors, setValidationErrors] = useState<ValidationError[]>([]);
    const [getTravelPlan, { data, error, isLoading }] = useGetTravelPlanMutation();

    const validateForm = useCallback((questionText: string): ValidationError[] => {
        const errors: ValidationError[] = [];

        if (!questionText || questionText.trim().length === 0) {
            errors.push({
                field: 'question',
                message: 'Please enter your travel question'
            });
            return errors;
        }

        if (questionText.trim().length < 10) {
            errors.push({
                field: 'question',
                message: 'Please provide more details about your travel plans (at least 10 characters)'
            });
        }

        if (questionText.trim().length > 500) {
            errors.push({
                field: 'question',
                message: 'Please keep your question under 500 characters'
            });
        }

        // Check for travel-related keywords
        const lowerQuestion = questionText.toLowerCase();
        const travelKeywords = ['trip', 'travel', 'vacation', 'plan', 'visit', 'tour', 'holiday', 'journey'];
        const hasKeyword = travelKeywords.some(keyword => lowerQuestion.includes(keyword));

        if (!hasKeyword) {
            errors.push({
                field: 'question',
                message: 'Please include travel-related keywords in your question (e.g., trip, travel, vacation, plan)'
            });
        }

        return errors;
    }, []);

    const handleSubmit = async (e: React.FormEvent) => {
        e.preventDefault();

        // Clear previous validation errors
        setValidationErrors([]);

        if (!question.trim()) {
            setValidationErrors([{ field: 'question', message: 'Please enter your travel question' }]);
            return;
        }

        // Validate the form
        const errors = validateForm(question.trim());
        if (errors.length > 0) {
            setValidationErrors(errors);
            return;
        }

        try {
            await getTravelPlan({ question: question.trim() }).unwrap();
        } catch (err: any) {
            console.error('Error getting travel plan:', err);

            // Handle validation errors from API
            if (err.status === 'VALIDATION_ERROR') {
                setValidationErrors([{ field: 'question', message: err.data }]);
            }
        }
    };

    const handleExampleClick = (exampleQuestion: string) => {
        setQuestion(exampleQuestion);
        setValidationErrors([]); // Clear any existing errors
    };

    const handleInputChange = (e: React.ChangeEvent<HTMLInputElement>) => {
        const value = e.target.value;
        setQuestion(value);

        // Clear validation errors when user starts typing
        if (validationErrors.length > 0 && value.trim()) {
            setValidationErrors([]);
        }
    };

    const handleReset = () => {
        setQuestion('');
        setValidationErrors([]);
        // Reset the data by reloading - in a real app, you'd want to reset the RTK Query state
        window.location.reload();
    };

    const hasValidationErrors = validationErrors.length > 0;
    const questionError = validationErrors.find(err => err.field === 'question');

    return (
        <div className="min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 dark:from-gray-900 dark:to-gray-800 theme-transition">
            {/* Header */}
            <header className="bg-white dark:bg-gray-900 shadow-sm border-b border-gray-200 dark:border-gray-700 theme-transition">
                <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4">
                    <div className="flex items-center justify-between">
                        <div className="flex items-center space-x-3">
                            <div className="w-10 h-10 bg-indigo-600 dark:bg-indigo-500 rounded-lg flex items-center justify-center theme-transition">
                                <MapPin className="w-6 h-6 text-white" />
                            </div>
                            <h1 className="text-2xl font-bold text-gray-900 dark:text-white theme-transition">AI Trip Planner</h1>
                        </div>

                        {/* Theme Toggle */}
                        <div className="flex items-center space-x-4">
                            <ThemeToggle variant="simple" size="md" />
                        </div>
                    </div>
                </div>
            </header>

            <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
                {!data ? (
                    <>
                        {/* Hero Section */}
                        <div className="text-center mb-12">
                            <h2 className="text-4xl font-bold text-gray-900 dark:text-white mb-4 theme-transition">
                                Plan Your Perfect Trip with AI
                            </h2>
                            <p className="text-xl text-gray-600 dark:text-gray-300 max-w-2xl mx-auto theme-transition">
                                Get personalized travel plans, recommendations, and itineraries tailored just for you.
                                Simply describe your dream destination and let our AI do the rest.
                            </p>
                        </div>

                        {/* Features Grid */}
                        <div className="grid md:grid-cols-4 gap-6 mb-12">
                            <div className="bg-white dark:bg-gray-800 rounded-xl p-6 shadow-sm border border-gray-100 dark:border-gray-700 theme-transition">
                                <Calendar className="w-10 h-10 text-indigo-600 dark:text-indigo-400 mb-4 theme-transition" />
                                <h3 className="font-semibold text-gray-900 dark:text-white mb-2 theme-transition">Smart Itineraries</h3>
                                <p className="text-gray-600 dark:text-gray-300 text-sm theme-transition">Optimized day-by-day plans based on your preferences</p>
                            </div>
                            <div className="bg-white dark:bg-gray-800 rounded-xl p-6 shadow-sm border border-gray-100 dark:border-gray-700 theme-transition">
                                <Hotel className="w-10 h-10 text-indigo-600 dark:text-indigo-400 mb-4 theme-transition" />
                                <h3 className="font-semibold text-gray-900 dark:text-white mb-2 theme-transition">Hotel Recommendations</h3>
                                <p className="text-gray-600 dark:text-gray-300 text-sm theme-transition">Curated accommodations for every budget</p>
                            </div>
                            <div className="bg-white dark:bg-gray-800 rounded-xl p-6 shadow-sm border border-gray-100 dark:border-gray-700 theme-transition">
                                <Utensils className="w-10 h-10 text-indigo-600 dark:text-indigo-400 mb-4 theme-transition" />
                                <h3 className="font-semibold text-gray-900 dark:text-white mb-2 theme-transition">Local Cuisine</h3>
                                <p className="text-gray-600 dark:text-gray-300 text-sm theme-transition">Discover authentic restaurants and local specialties</p>
                            </div>
                            <div className="bg-white dark:bg-gray-800 rounded-xl p-6 shadow-sm border border-gray-100 dark:border-gray-700 theme-transition">
                                <DollarSign className="w-10 h-10 text-indigo-600 dark:text-indigo-400 mb-4 theme-transition" />
                                <h3 className="font-semibold text-gray-900 dark:text-white mb-2 theme-transition">Budget Planning</h3>
                                <p className="text-gray-600 dark:text-gray-300 text-sm theme-transition">Detailed cost breakdowns and budget estimates</p>
                            </div>
                        </div>

                        {/* Search Form */}
                        <div className="bg-white dark:bg-gray-800 rounded-2xl shadow-lg p-8 mb-8 border border-gray-100 dark:border-gray-700 theme-transition">
                            <form onSubmit={handleSubmit} className="space-y-6">
                                <div>
                                    <label htmlFor="travel-question" className="block text-lg font-medium text-gray-900 dark:text-white mb-3 theme-transition">
                                        Where would you like to go?
                                    </label>
                                    <div className="relative">
                                        <input
                                            id="travel-question"
                                            type="text"
                                            value={question}
                                            onChange={handleInputChange}
                                            placeholder="e.g., Plan a 7-day romantic trip to Italy with a budget of $3000"
                                            className={`w-full px-6 py-4 pr-16 text-lg border rounded-xl focus:outline-none focus:ring-2 focus:border-transparent transition-colors theme-transition
                                                bg-white dark:bg-gray-700 
                                                text-gray-900 dark:text-white 
                                                placeholder-gray-500 dark:placeholder-gray-400
                                                ${questionError
                                                    ? 'border-red-300 dark:border-red-600 focus:ring-red-500'
                                                    : 'border-gray-300 dark:border-gray-600 focus:ring-indigo-500'
                                                }`}
                                            disabled={isLoading}
                                            aria-invalid={hasValidationErrors}
                                            aria-describedby={questionError ? 'question-error' : undefined}
                                        />
                                        <button
                                            type="submit"
                                            disabled={isLoading || !question.trim()}
                                            className="absolute right-2 top-1/2 transform -translate-y-1/2 bg-indigo-600 hover:bg-indigo-700 dark:bg-indigo-500 dark:hover:bg-indigo-600 text-white p-3 rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed theme-transition"
                                        >
                                            {isLoading ? (
                                                <div className="w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin" />
                                            ) : (
                                                <Send className="w-5 h-5" />
                                            )}
                                        </button>
                                    </div>

                                    {/* Validation Error Display */}
                                    {questionError && (
                                        <div id="question-error" className="mt-2 flex items-center space-x-2 text-red-600 dark:text-red-400 theme-transition">
                                            <AlertCircle className="w-4 h-4" />
                                            <span className="text-sm">{questionError.message}</span>
                                        </div>
                                    )}
                                </div>
                            </form>

                            {/* Example Questions */}
                            <div className="mt-6">
                                <p className="text-sm text-gray-600 dark:text-gray-400 mb-3 theme-transition">Try these examples:</p>
                                <div className="flex flex-wrap gap-2">
                                    {EXAMPLE_TRAVEL_QUESTIONS.map((example, index) => (
                                        <button
                                            key={index}
                                            onClick={() => handleExampleClick(example)}
                                            disabled={isLoading}
                                            className="px-4 py-2 bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded-full text-sm hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors flex items-center space-x-1 disabled:opacity-50 disabled:cursor-not-allowed theme-transition"
                                        >
                                            <span>{example}</span>
                                            <ArrowRight className="w-3 h-3" />
                                        </button>
                                    ))}
                                </div>
                            </div>
                        </div>

                        {/* Loading State */}
                        {isLoading && (
                            <div className="bg-white dark:bg-gray-800 rounded-2xl shadow-lg p-12 text-center border border-gray-100 dark:border-gray-700 theme-transition">
                                <div className="w-16 h-16 border-4 border-indigo-600 dark:border-indigo-400 border-t-transparent rounded-full animate-spin mx-auto mb-4" />
                                <h3 className="text-xl font-semibold text-gray-900 dark:text-white mb-2 theme-transition">Creating Your Perfect Trip</h3>
                                <p className="text-gray-600 dark:text-gray-300 theme-transition">Our AI is analyzing destinations, costs, and creating your personalized itinerary...</p>
                            </div>
                        )}

                        {/* Error State */}
                        {error && (
                            <div className="bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-2xl p-6 text-center theme-transition">
                                <div className="w-12 h-12 bg-red-100 dark:bg-red-900/40 rounded-full flex items-center justify-center mx-auto mb-4">
                                    <AlertCircle className="w-6 h-6 text-red-600 dark:text-red-400" />
                                </div>
                                <h3 className="text-lg font-semibold text-red-900 dark:text-red-300 mb-2 theme-transition">Something went wrong</h3>
                                <p className="text-red-700 dark:text-red-400 theme-transition">
                                    {typeof error === 'object' && 'data' in error
                                        ? String(error.data)
                                        : 'We couldn\'t generate your travel plan. Please try again.'
                                    }
                                </p>
                                <button
                                    onClick={() => setQuestion('')}
                                    className="mt-4 px-4 py-2 bg-red-600 hover:bg-red-700 dark:bg-red-500 dark:hover:bg-red-600 text-white rounded-lg transition-colors theme-transition"
                                >
                                    Try Again
                                </button>
                            </div>
                        )}
                    </>
                ) : (
                    <TravelPlanDisplay
                        data={data}
                        onNewSearch={handleReset}
                    />
                )}
            </div>
        </div>
    );
};

export default TravelPlannerHome;

-- ./src/services/api/api_client.ts --



-- ./src/services/api/travel/travelApi.ts --
// src/services/api/travel/travelApi.ts
import { createApi, fetchBaseQuery } from "@reduxjs/toolkit/query/react";
import { ApiConstants } from "../../../utils/constants/api_constants";

// Inline types for now - you can move these to a separate types file
export interface TravelQuery {
    question: string;
}

export interface TravelResponse {
    answer: string;
}

// Travel API definition with basic validation
export const travelApi = createApi({
    reducerPath: "travelApi",
    baseQuery: fetchBaseQuery({
        baseUrl: ApiConstants.TRAVEL_API_BASE_URL,
        prepareHeaders: (headers) => {
            // Add ngrok bypass header to avoid browser warning
            headers.set('ngrok-skip-browser-warning', 'true');
            headers.set('Content-Type', 'application/json');
            return headers;
        },
    }),
    tagTypes: ['TravelPlan'],
    endpoints: (builder) => ({
        getTravelPlan: builder.mutation<TravelResponse, TravelQuery>({
            query: (travelQuery) => {
                // Basic validation - ensure question is not empty
                if (!travelQuery.question || travelQuery.question.trim().length === 0) {
                    throw new Error('Travel question cannot be empty');
                }

                if (travelQuery.question.trim().length < 10) {
                    throw new Error('Please provide more details about your travel plans (at least 10 characters)');
                }

                return {
                    url: ApiConstants.TRAVEL_QUERY_ENDPOINT,
                    method: "POST",
                    headers: {
                        "Content-Type": "application/json",
                        "ngrok-skip-browser-warning": "true"
                    },
                    body: travelQuery,
                };
            },
            transformResponse: (response: any): TravelResponse => {
                // Basic response validation
                if (!response || typeof response.answer !== 'string') {
                    throw new Error('Invalid response from server');
                }
                return response;
            },
            transformErrorResponse: (response: any) => {
                console.error('Travel API Error:', response);

                return {
                    status: response.status || 'UNKNOWN_ERROR',
                    data: response.data || 'An unexpected error occurred'
                };
            },
            invalidatesTags: ['TravelPlan'],
        }),
    }),
});

// Export the hook
export const { useGetTravelPlanMutation } = travelApi;

